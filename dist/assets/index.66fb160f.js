const B=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerpolicy&&(l.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?l.credentials="include":a.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}};B();const I=56,N=7;function G(){const e=document.querySelector("main");let n=document.querySelector("input").value;console.log("Number of players: "+n);let r=document.getElementById("info"),a=document.createElement("p");a.textContent="Number of players: "+n,r.appendChild(a),document.querySelector("form").remove();const l=document.createElement("form"),o=document.createElement("button"),c=document.createElement("input");return o.innerText="Add",c.type="text",c.name="player",c.placeholder=" Type your username....",c.autofocus="true",e.appendChild(l),l.appendChild(c),l.appendChild(o),n}function L(){const e=document.createElement("button");return e.setAttribute("id","start-game"),e.textContent="Start game!",e}function h(e,t){const n=document.getElementById("players");n.textContent="";for(let r of e){const a=document.createElement("li"),l=document.createElement("p");l.textContent="Player "+r.gamerNum+" : "+r.name,n.appendChild(a),a.append(l),a.setAttribute("player",r.gamerNum);for(let o=0;o<r.numCards();o++){const c=document.createElement("img");c.src=r.cards[o].showImage(r.cards[o].cardName),c.setAttribute("class",r.cards[o].cardName),a.append(c)}}P(t,e)}function A(e,t,n,r){const a=document.querySelector("main"),l=document.getElementById("fullTable");l.textContent="";const o=document.createElement("div"),c=document.createElement("div");o.setAttribute("id","cardsInGame"),c.setAttribute("id","table");const s=document.createElement("img"),i=document.createElement("img"),m=document.createElement("p"),g=document.createElement("p");s.src=e[e.length-1].showImage(e[e.length-1].cardName),i.setAttribute("class",e[e.length-1].cardName),i.src=n[n.length-1].showImage(n[n.length-1].cardName),i.setAttribute("class",n[n.length-1].cardName),m.textContent=t,g.textContent=r,o.append(m),c.append(g),o.append(s),c.append(i),l.appendChild(o),l.appendChild(c),a.appendChild(l)}function S(e,t){document.getElementById("cardsInGame").replaceChild(t,e)}function C(e,t,n){let r=document.getElementById("table");const a=document.createElement("img");a.src=n.showImage(n.cardName),a.setAttribute("class",n.cardName),r.replaceChild(a,t)}function w(e){const t=document.createElement("div");t.setAttribute("id","turn-info");const n=document.createElement("p");n.textContent="It's your turn: ";const r=document.createElement("button");return r.textContent=e.gamers[0].name,r.setAttribute("id","turnButton"),document.getElementById("info").appendChild(t),t.appendChild(n),t.appendChild(r),e.gamers[0].myTurn(),r}function y(e,t,n,r){e.gamers[t].myTurn(),r==!1?t=(t+1)%n:t==0?t=n-1:t=Math.abs(t-1)%n;let a=document.getElementById("turnButton");return a.textContent=e.gamers[t].name,e.gamers[t].myTurn(),t}function P(e,t){let n=document.getElementById("playerUno_"+t[e].name);if(t[e].numCards()==2&&n!=null&&n.remove(),t[e].numCards()==2){let r=document.getElementsByTagName("li")[e],a=document.createElement("p");a.setAttribute("id","uno");let l=document.createElement("button");l.textContent="UNO",a.append(l),r.append(a),l.addEventListener("click",o=>{let c=document.getElementById("unoPlayers");if(console.log(">> A "+t[e].name+" le queda UNO!"),c==null){let s=document.createElement("div");s.setAttribute("id","unoPlayers");let i=document.getElementById("info"),m=document.createElement("p");m.setAttribute("id","playerUno_"+t[e].name),m.textContent=t[e].name+" has said UNO!",s.appendChild(m),i.appendChild(s)}else{let s=document.createElement("p");s.setAttribute("id","playerUno_"+t[e].name),s.textContent=t[e].name+" has said UNO!",c.appendChild(s)}})}}function k(e){let t=!1;for(let n of e.gamers)if(n.isEmpty()){t=!0;let r=document.getElementById("info"),a=document.createElement("p");a.setAttribute("id","ganador"),a.textContent=n.name+" wins the game!!",r.appendChild(a),console.log(">> "+n.name+" wins the game!!")}return t}let d=0,p=!1,u=!1;const x=document.querySelector("main"),q=document.querySelector("form");q.addEventListener("submit",e=>{e.preventDefault();let t=G(),n=[];const r=document.querySelector("form");r.addEventListener("submit",a=>{a.preventDefault();let l=document.querySelector("input");if(n=F(n,l),h(n,d),n.length!=t)console.log(">> Waiting for players...");else{let o=L();x.appendChild(o),r.remove(),o.addEventListener("click",c=>{c.preventDefault(),o.remove();let s=_(n);h(s.gamers,d),A(s.cardsInGame,"Card in game:",s.table,"Deck of cards to take:"),console.log(">> The initial table is:"),console.log(s),w(s).addEventListener("click",m=>{if(h(s.gamers,d),p==!0)d=M(s,d),p=!1;else{let g=document.getElementById("players").querySelectorAll("img");for(let f=0;f<g.length;f++)g[f].addEventListener("click",R=>{p=T(s,g,f,p)});let E=document.getElementById("table").querySelector("img");E.addEventListener("click",f=>{p=D(s,E,p)})}})})}})});function T(e,t,n,r){let a=e.gamers[d];for(let l=0;l<a.numCards();l++)if(a.cards[l].cardName==t[n].className){e.throwCard(a.cards[l],e.gamers[d],l);let o=document.getElementById("cardsInGame").querySelector("img");if(S(o,t[n]),(e.cardsInGame[e.cardsInGameLength()-1].cardName.includes("+4")||e.cardsInGame[e.cardsInGameLength()-1].cardName.includes("+2"))&&(r=!0),e.cardsInGame[e.cardsInGameLength()-1].cardName.includes("Direction")&&(u=!u),e.cardsInGame[e.cardsInGameLength()-1].cardName.includes("Forbbiden")&&(d=y(e,d,e.gamers.length,u)),k(e)==!0){document.getElementById("turn-info").remove();let i=document.getElementById("unoPlayers");i!=null&&i.remove(),console.log(e)}else d=y(e,d,e.gamers.length,u)}return r}function D(e,t,n){let r=e.gamers[d];if(e.table[e.table.length-1].cardName==t.className){e.pickCard(r),h(e.gamers,d),C(e,t,e.table[e.table.length-1]);let a=document.getElementById("players").querySelectorAll("img");for(let s=0;s<a.length;s++)a[s].addEventListener("click",i=>{n=T(e,a,s,n)});let l=document.getElementsByTagName("li")[d],o=document.createElement("p");o.setAttribute("id","skip");let c=document.createElement("button");c.textContent="SKIP",o.append(c),l.append(o),c.addEventListener("click",s=>{console.log(">> "+r.name+" passes the turn"),d=y(e,d,e.gamers.length,u)})}return n}function M(e,t){if(e.cardsInGame[e.cardsInGameLength()-1].cardName.includes("+4")){console.log(">> The special card +4\uFE0F\u20E3 has been thrown");for(let n=0;n<4;n++){e.pickCard(e.gamers[t]),h(e.gamers,t);let r=document.getElementById("table").querySelector("img");C(e,r,e.table[e.table.length-1])}t=y(e,t,e.gamers.length,u)}else if(e.cardsInGame[e.cardsInGameLength()-1].cardName.includes("+2")){console.log(">> The special card +2\uFE0F\u20E3 has been thrown");for(let n=0;n<2;n++){e.pickCard(e.gamers[t]),h(e.gamers,t);let r=document.getElementById("table").querySelector("img");C(e,r,e.table[e.table.length-1])}t=y(e,t,e.gamers.length,u)}return t}class v{constructor(t){this.cardName=t,this.isVisible=!1}flip(){this.isVisible=!this.isVisible}showImage(t){return this.isVisible==!0?"./images/cards/"+t+".png":"./images/cards/uno-reves.png"}}class U{constructor(t,n){this.name=n,this.gamerNum=t,this.cards=[],this.isMyTurn=!1}numCards(){return this.cards.length}isEmpty(){return this.cards.length==0}myTurn(){for(let t of this.cards)t.flip();this.isMyTurn=!this.isMyTurn,this.isMyTurn==!0&&console.log(">> It's the turn of "+this.name)}pickCard(t){this.cards.push(t),console.log(">> "+this.name+" pick the card: "+t.cardName)}throwCard(t){let n=this.cards.splice(t,1)[0];return console.log(">> "+this.name+" throws the card: "+n.cardName),n}printCards(){console.log(">> "+this.name+" has "+this.numCards()+" cards:"),console.log(this.cards)}}class O{constructor(){this.table=[],this.cardsInGame=[],this.gamers=[]}startCards(){this.table=[];const t=[0,1,2,3,4,5,6,7,8,9,"+2","Direction","Forbbiden"],n=["red","green","blue","yellow"],r=["multicolor_1","multicolor_2","+4_1","+4_2"];for(let a in n)for(let l in t)this.table.push(new v(n[a]+""+t[l]));for(let a in r)this.table.push(new v(r[a]));this.table.sort(function(){return Math.random()-.5})}dealCards(){for(let t of this.gamers){console.log(">> Dealing "+N+" cards to "+t.name);for(let n=0;n<N;n++){let r=b(0,this.tableLength()),a=this.table.splice(r,1)[0];t.cards.push(a)}console.log(t.cards)}}cardToStart(){let t=b(0,this.tableLength()),n=this.table.splice(t,1)[0];for(;n.cardName.includes("multicolor")||n.cardName.includes("+4")||n.cardName.includes("+2")||n.cardName.includes("Forbbiden")||n.cardName.includes("Direction");)this.table.splice(t,0,n),t=b(0,this.tableLength()),n=this.table.splice(t,1)[0];n.flip(),this.cardsInGame.push(n),console.log(">> Start card: "+n.cardName)}addGamer(t){this.gamers.push(t)}pickCard(t){let n=this.table.pop();return n.flip(),t.pickCard(n),n}throwCard(t,n,r){n.isMyTurn==!0?(n.throwCard(r),this.cardsInGame.push(t)):console.log(">> No es mi turno, por eso no puedo tirar")}tableLength(){return this.table.length}cardsInGameLength(){return this.cardsInGame.length}printTable(){console.log("Deck of cards to take: "),console.log(this.table)}printCardsInGame(){console.log("Cards in game: "),console.log(this.cardsInGame)}printPlayersCards(){for(let t of this.gamers)t.printCards()}}function b(e,t){return Math.floor(Math.random()*(t-e)+e)}function _(e){let t=new O;t.startCards(),t.tableLength()==I?console.log(">> The table are ready"):console.log(">> The table doesn't have "+I+" dealCards"),console.log(">> Number of cards in game: "+t.tableLength()),console.log(">> Number of gamers: "+e.length);for(let n of e)t.addGamer(n);return t.dealCards(),t.cardToStart(),t}function F(e,t){let n;if(t.value!=="")return n=new U(e.length,t.value),console.log(">> Player "+e.length+" : "+n.name),t.value="",e.push(n),e}
